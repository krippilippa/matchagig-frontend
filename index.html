<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Bulk ZIP → /v1/bulk-zip (Demo)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- layout only -->
  <style>
    html, body { height: 100%; margin: 0; }
    .app { display: grid; grid-template-columns: 320px 1fr 400px; height: 100vh; }
    .left { padding: 8px; overflow: auto; }
    .right { padding: 8px; overflow: auto; }
    .chat { padding: 8px; overflow: auto; border-left: 1px solid #ddd; }
    .row { display: flex; justify-content: space-between; gap: 8px; padding: 6px 4px; cursor: pointer; }
    .row:hover { outline: 1px dotted #ccc; }
    .toolbar { display: grid; gap: 8px; }
    .list { margin-top: 12px; }
    .pdf { width: 100%; height: 50vh; border: 1px solid #ddd; margin-bottom: 16px; }
    #explainMd { 
      background: #f5f5f5; 
      padding: 12px; 
      border: 1px solid #ddd; 
      max-height: 40vh; 
      overflow: auto; 
      white-space: pre-wrap; 
      font-family: monospace; 
      font-size: 12px; 
    }
    #chatLog { 
      max-height: 300px; 
      overflow-y: auto; 
      margin-bottom: 16px; 
      border: 1px solid #ddd; 
      padding: 8px; 
      background: #f9f9f9; 
    }
    #chatLog .user { 
      background: #e3f2fd; 
      padding: 8px; 
      margin: 4px 0; 
      border-radius: 4px; 
      font-weight: bold; 
    }
    #chatLog .assistant { 
      background: #f1f8e9; 
      padding: 8px; 
      margin: 4px 0; 
      border-radius: 4px; 
      white-space: pre-wrap; 
      font-family: monospace; 
      font-size: 12px; 
    }
    #chatActions { 
      display: grid; 
      gap: 4px; 
      margin-bottom: 16px; 
    }
    #chatActions button { 
      padding: 8px; 
      font-size: 12px; 
      text-align: left; 
    }
    #chatInput { 
      display: flex; 
      gap: 8px; 
      align-items: flex-start; 
    }
    #chatText { 
      flex: 1; 
      resize: vertical; 
    }
    #btnSend { 
      padding: 8px 16px; 
      white-space: nowrap; 
    }
  </style>
  <!-- JSZip in browser to make a zip from PDFs -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
</head>
<body>
  <div class="app">
    <aside class="left">
                        <div class="toolbar">
                    <input type="file" id="pdfInput" accept="application/pdf" multiple />
                    <label for="jdText">Job Description (for bulk-zip processing):</label>
                    <textarea id="jdText" rows="6" placeholder="Paste the full job description here for bulk processing..." required></textarea>
                    <div id="jdStatus" style="font-size: 12px; color: #666; margin-top: 4px;"></div>
                    <label for="jdHash">JD hash (required for LLM explanations):</label>
                    <input id="jdHash" type="text" placeholder="e.g. f39d42dbe2bbbb76" required />
                    <small style="color: #666;">⚠️ JD hash is required for LLM explanations. You can get this from the bulk-zip response or enter manually.</small>
                    <div style="font-size: 11px; color: #888; margin: 4px 0; padding: 8px; background: #f5f5f5; border-radius: 4px;">
                      <strong>Workflow:</strong><br>
                      1. Paste job description and upload resumes via bulk-zip<br>
                      2. Get jdHash from the response or enter manually<br>
                      3. Use jdHash for LLM explanations when clicking candidates
                    </div>
                    <button id="sendBtn">Zip & Send to /v1/bulk-zip</button>
                    <button id="refreshBtn" style="font-size: 12px; padding: 4px 8px;">Refresh Stored Data</button>
                    <button id="clearStorageBtn" style="font-size: 12px; padding: 4px 8px; background-color: #ff6b6b; color: white; border: none;">Clear All Storage</button>
                    <div id="status"></div>
                  </div>

      <div class="list" id="list"></div>
    </aside>

    <main class="right">
      <h3 id="viewerTitle">No candidate selected</h3>
      <iframe id="pdfFrame" class="pdf"></iframe>
      <pre id="explainMd"></pre>
    </main>

    <aside class="chat">
      <div id="chat">
        <div id="chatLog"></div>
        <div id="chatActions">
          <button id="btnExplain">Initial assessment</button>
          <button data-mode="interview_questions">Interview questions</button>
          <button data-mode="email_candidate">Email candidate</button>
          <button data-mode="email_hiring_manager">Email hiring manager</button>
        </div>
        <div id="chatInput">
          <textarea id="chatText" rows="3" placeholder="Ask something..."></textarea>
          <button id="btnSend">Send</button>
        </div>
      </div>
    </aside>
  </div>

  <script type="module" src="./main.js"></script>
</body>
</html>